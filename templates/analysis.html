
<link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
<div class="topbar">

    
    <h1 class="page-title">
        <i class="fas fa-graduation-cap"></i> Signal Training
    </h1>
    <div class="topbar-actions">
        <button class="btn btn-primary" onclick="openModal('addLocationModal')">
            <i class="fas fa-plus"></i> Add Location
        </button>
    </div>
</div>

<!-- Locations Grid -->
<div class="card">
    <div class="card-header">
        <h2 class="card-title">
            <i class="fas fa-map-marked-alt"></i> Your Locations
        </h2>
        <p style="color: #64748b; font-size: 0.95rem; margin: 0;">
            Select a location to start training a new traffic signal
        </p>
    </div>
    <div id="locationsContainer">
        <div class="flex-center" style="padding: 3rem;">
            <div class="spinner"></div>
            <p style="margin-left: 1rem; color: #64748b;">Loading locations...</p>
        </div>
    </div>
</div>

<!-- Add Location Modal -->
<div id="addLocationModal" class="modal">
    <div class="modal-content" style="max-width: 700px;">
        <div class="modal-header">
            <h3 class="modal-title">
                <i class="fas fa-map-marked-alt"></i> Add New Location
            </h3>
            <button class="modal-close" onclick="closeModal('addLocationModal')">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <form onsubmit="handleLocationForm(event)">
            <div class="form-group">
                <label class="form-label" for="locationName">
                    <i class="fas fa-building"></i> Location Name *
                </label>
                <input type="text" class="form-control" id="locationName" 
                       placeholder="e.g., Main Street Intersection" required>
                <small style="color: #64748b; display: block; margin-top: 0.5rem;">
                    Give your location a descriptive name for easy identification
                </small>
            </div>
            
            <div class="form-group">
                <label class="form-label" for="locationAddress">
                    <i class="fas fa-map-marker-alt"></i> Address
                </label>
                <input type="text" class="form-control" id="locationAddress" 
                       placeholder="123 Main Street">
                <small style="color: #64748b; display: block; margin-top: 0.5rem;">
                    Full street address (optional but recommended)
                </small>
            </div>
            
            <div class="form-group">
                <label class="form-label" for="locationCity">
                    <i class="fas fa-city"></i> City
                </label>
                <input type="text" class="form-control" id="locationCity" 
                       placeholder="e.g., San Francisco">
            </div>
            
            <div class="grid-2">
                <div class="form-group">
                    <label class="form-label" for="locationLat">
                        <i class="fas fa-globe"></i> Latitude
                    </label>
                    <input type="number" step="any" class="form-control" id="locationLat" 
                           placeholder="e.g., 40.7128">
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="locationLng">
                        <i class="fas fa-globe"></i> Longitude
                    </label>
                    <input type="number" step="any" class="form-control" id="locationLng" 
                           placeholder="e.g., -74.0060">
                </div>
            </div>
            
            <div class="alert alert-info" style="margin-bottom: 1.5rem;">
                <i class="fas fa-info-circle"></i>
                <span>Latitude and longitude are optional but help with mapping features</span>
            </div>
            
            <div class="form-group">
                <label class="form-label" for="numLanes">
                    <i class="fas fa-road"></i> Number of Lanes *
                </label>
                <input type="number" class="form-control" id="numLanes" 
                       min="1" max="10" placeholder="e.g., 4" required>
                <small style="color: #64748b; display: block; margin-top: 0.5rem;">
                    Specify how many traffic lanes you'll be monitoring (1-10)
                </small>
            </div>
            
            <div style="background: #f8fafc; padding: 1.5rem; border-radius: 12px; margin-bottom: 1.5rem;">
                <h4 style="color: var(--dark); margin-bottom: 1rem; font-size: 1rem;">
                    <i class="fas fa-lightbulb"></i> Quick Tips
                </h4>
                <ul style="margin: 0; padding-left: 1.5rem; color: #64748b; line-height: 1.8;">
                    <li>The number of lanes should match the camera feeds you'll upload</li>
                    <li>Choose a unique, descriptive name for easy identification</li>
                    <li>You can manage multiple locations from your dashboard</li>
                </ul>
            </div>
            
            <div class="flex gap-2" style="margin-top: 2rem;">
                <button type="submit" class="btn btn-primary" style="flex: 1;">
                    <i class="fas fa-plus"></i> Add Location
                </button>
                <button type="button" class="btn btn-outline" style="flex: 1;" 
                        onclick="closeModal('addLocationModal')">
                    <i class="fas fa-times"></i> Cancel
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Analysis/Upload Modal -->
<div id="analysisModal" class="modal">
    <div class="modal-content" style="max-width: 1000px;">
        <div class="modal-header">
            <h3 class="modal-title">
                <i class="fas fa-video"></i> Upload Videos for Analysis
            </h3>
            <button class="modal-close" onclick="closeModal('analysisModal')">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="alert alert-info" style="margin-bottom: 2rem;">
            <i class="fas fa-info-circle"></i>
            <div style="flex: 1;">
                <strong>Important:</strong> Please upload video files for each lane. 
                Ensure all videos are from the same time period for accurate analysis.
                <br>
                <small>Supported formats: MP4, AVI, MOV | Max size: 500MB per file</small>
            </div>
        </div>
        
        <div id="uploadContainer" class="grid-2" style="margin-bottom: 2rem;">
            <!-- Upload areas will be dynamically generated here by JavaScript -->
        </div>
        
        <div style="background: #f8fafc; padding: 1.5rem; border-radius: 12px; margin-bottom: 2rem;">
            <h4 style="color: var(--dark); margin-bottom: 1rem; font-size: 1rem;">
                <i class="fas fa-clock"></i> Processing Information
            </h4>
            <p style="color: #64748b; margin: 0; line-height: 1.8;">
                Video processing uses YOLO for vehicle detection and DDQN for signal optimization. 
                Processing time varies based on video length and system performance. 
                You'll be notified when the analysis is complete.
            </p>
        </div>
        
        <div class="flex gap-2">
            <button id="submitAnalysis" class="btn btn-primary" style="flex: 1;">
                <i class="fas fa-rocket"></i> Start Analysis
            </button>
            <button type="button" class="btn btn-outline" style="flex: 1;" 
                    onclick="closeModal('analysisModal')">
                <i class="fas fa-times"></i> Cancel
            </button>
        </div>
    </div>
</div>

<!-- How It Works Section -->
<div class="card" style="background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); border: none;">
    <h2 style="color: var(--dark); margin-bottom: 2rem; text-align: center;">
        <i class="fas fa-question-circle"></i> How Signal Training Works
    </h2>
    
    <div class="grid-3">
        <div style="background: white; padding: 2rem; border-radius: 16px; text-align: center; box-shadow: 0 4px 12px rgba(0,0,0,0.08);">
            <div style="width: 80px; height: 80px; margin: 0 auto 1.5rem; border-radius: 50%; background: linear-gradient(135deg, var(--primary), var(--secondary)); display: flex; align-items: center; justify-content: center;">
                <i class="fas fa-map-plus" style="font-size: 2rem; color: white;"></i>
            </div>
            <h3 style="color: var(--dark); margin-bottom: 1rem; font-size: 1.25rem;">1. Add Location</h3>
            <p style="color: #64748b; line-height: 1.8;">
                Create a new location with the number of lanes you want to monitor. 
                Provide address details for better organization.
            </p>
        </div>
        
        <div style="background: white; padding: 2rem; border-radius: 16px; text-align: center; box-shadow: 0 4px 12px rgba(0,0,0,0.08);">
            <div style="width: 80px; height: 80px; margin: 0 auto 1.5rem; border-radius: 50%; background: linear-gradient(135deg, var(--success), #059669); display: flex; align-items: center; justify-content: center;">
                <i class="fas fa-video" style="font-size: 2rem; color: white;"></i>
            </div>
            <h3 style="color: var(--dark); margin-bottom: 1rem; font-size: 1.25rem;">2. Upload Videos</h3>
            <p style="color: #64748b; line-height: 1.8;">
                Provide video footage for each lane from your traffic cameras. 
                Drag and drop or click to upload files.
            </p>
        </div>
        
        <div style="background: white; padding: 2rem; border-radius: 16px; text-align: center; box-shadow: 0 4px 12px rgba(0,0,0,0.08);">
            <div style="width: 80px; height: 80px; margin: 0 auto 1.5rem; border-radius: 50%; background: linear-gradient(135deg, var(--warning), #d97706); display: flex; align-items: center; justify-content: center;">
                <i class="fas fa-brain" style="font-size: 2rem; color: white;"></i>
            </div>
            <h3 style="color: var(--dark); margin-bottom: 1rem; font-size: 1.25rem;">3. AI Training</h3>
            <p style="color: #64748b; line-height: 1.8;">
                Our AI analyzes traffic patterns using YOLO detection and DDQN learning 
                to optimize signal timing automatically.
            </p>
        </div>
    </div>
    
    <div style="background: white; padding: 2rem; border-radius: 16px; margin-top: 2rem; box-shadow: 0 4px 12px rgba(0,0,0,0.08);">
        <h3 style="color: var(--dark); margin-bottom: 1.5rem; text-align: center;">
            <i class="fas fa-robot"></i> AI Technology Stack
        </h3>
        
        <div class="grid-2" style="gap: 2rem;">
            <div>
                <h4 style="color: var(--primary); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                    <i class="fas fa-eye"></i> Vehicle Detection (YOLO11)
                </h4>
                <p style="color: #64748b; line-height: 1.8; margin-bottom: 1rem;">
                    State-of-the-art object detection model that identifies vehicles in real-time:
                </p>
                <ul style="color: #64748b; line-height: 1.8; padding-left: 1.5rem;">
                    <li>Cars, motorcycles, buses, trucks, bicycles</li>
                    <li>High accuracy with low latency</li>
                    <li>Works in various lighting conditions</li>
                    <li>Processes multiple lanes simultaneously</li>
                </ul>
            </div>
            
            <div>
                <h4 style="color: var(--success); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                    <i class="fas fa-graduation-cap"></i> Signal Optimization (DDQN)
                </h4>
                <p style="color: #64748b; line-height: 1.8; margin-bottom: 1rem;">
                    Double Deep Q-Network reinforcement learning for intelligent timing:
                </p>
                <ul style="color: #64748b; line-height: 1.8; padding-left: 1.5rem;">
                    <li>Learns optimal signal patterns</li>
                    <li>Adapts to traffic density in real-time</li>
                    <li>Minimizes overall wait times</li>
                    <li>Improves with more training data</li>
                </ul>
            </div>
        </div>
    </div>
</div>

<!-- Best Practices Section -->
<div class="card">
    <h2 class="card-title">
        <i class="fas fa-star"></i> Best Practices for Optimal Results
    </h2>
    
    <div class="grid-2" style="margin-top: 1.5rem; gap: 1.5rem;">
        <div style="border-left: 4px solid var(--primary); padding-left: 1.5rem;">
            <h4 style="color: var(--dark); margin-bottom: 0.75rem;">
                <i class="fas fa-check-circle" style="color: var(--primary);"></i> Do's
            </h4>
            <ul style="color: #64748b; line-height: 2; margin: 0; padding-left: 1.5rem;">
                <li>Use videos from the same time period</li>
                <li>Ensure clear visibility of vehicles</li>
                <li>Use consistent video quality across lanes</li>
                <li>Include peak traffic hours for better learning</li>
                <li>Use videos at least 1-2 minutes long</li>
                <li>Verify all camera angles capture the full lane</li>
            </ul>
        </div>
        
        <div style="border-left: 4px solid var(--danger); padding-left: 1.5rem;">
            <h4 style="color: var(--dark); margin-bottom: 0.75rem;">
                <i class="fas fa-times-circle" style="color: var(--danger);"></i> Don'ts
            </h4>
            <ul style="color: #64748b; line-height: 2; margin: 0; padding-left: 1.5rem;">
                <li>Don't use videos from different time periods</li>
                <li>Avoid extremely low quality or dark footage</li>
                <li>Don't mix different frame rates</li>
                <li>Avoid videos with major obstructions</li>
                <li>Don't use corrupted or incomplete videos</li>
                <li>Avoid videos with inconsistent timestamps</li>
            </ul>
        </div>
    </div>
</div>

<!-- FAQ Section -->
<div class="card" style="background: #f8fafc;">
    <h2 class="card-title">
        <i class="fas fa-question-circle"></i> Frequently Asked Questions
    </h2>
    
    <div style="margin-top: 1.5rem;">
        <div style="background: white; padding: 1.5rem; border-radius: 12px; margin-bottom: 1rem; border-left: 4px solid var(--primary);">
            <h4 style="color: var(--dark); margin-bottom: 0.5rem;">How long does processing take?</h4>
            <p style="color: #64748b; margin: 0; line-height: 1.8;">
                Processing time varies based on video length and system resources. A typical 2-minute video 
                with 4 lanes takes approximately 5-10 minutes. You'll be notified when complete.
            </p>
        </div>
        
        <div style="background: white; padding: 1.5rem; border-radius: 12px; margin-bottom: 1rem; border-left: 4px solid var(--success);">
            <h4 style="color: var(--dark); margin-bottom: 0.5rem;">What video formats are supported?</h4>
            <p style="color: #64748b; margin: 0; line-height: 1.8;">
                We support MP4, AVI, and MOV formats. Each video file can be up to 500MB. 
                For best results, use MP4 with H.264 encoding.
            </p>
        </div>
        
        <div style="background: white; padding: 1.5rem; border-radius: 12px; margin-bottom: 1rem; border-left: 4px solid var(--warning);">
            <h4 style="color: var(--dark); margin-bottom: 0.5rem;">Can I train multiple signals simultaneously?</h4>
            <p style="color: #64748b; margin: 0; line-height: 1.8;">
                Currently, signals are processed sequentially to ensure optimal performance. 
                You can queue multiple analyses, and they'll be processed in order.
            </p>
        </div>
        
        <div style="background: white; padding: 1.5rem; border-radius: 12px; border-left: 4px solid var(--info);">
            <h4 style="color: var(--dark); margin-bottom: 0.5rem;">How accurate is the vehicle detection?</h4>
            <p style="color: #64748b; margin: 0; line-height: 1.8;">
                Our YOLO11 model achieves over 95% accuracy in optimal conditions. 
                Accuracy may vary based on video quality, lighting, and camera angle.
            </p>
        </div>
    </div>
</div>


