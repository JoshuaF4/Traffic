{% extends "base.html" %}

{% block title %}Signal Inventory - TrafficAI Pro{% endblock %}

{% block content %}
<div class="topbar">
    <h1 class="page-title">
        <i class="fas fa-warehouse"></i> Signal Inventory
    </h1>
    <div class="topbar-actions">
        <button class="btn btn-outline">
            <i class="fas fa-download"></i> Export Report
        </button>
<a href="{{ url_for('signal_training') }}" class="btn btn-primary">
            <i class="fas fa-plus"></i> Train New Signal
        </button>
    </div>
</div>

<!-- Filter Section -->
<div class="card">
    <div class="flex-between">
        <div class="flex gap-2">
            <button class="btn btn-primary" onclick="filterSignals('all')">
                <i class="fas fa-list"></i> All
            </button>
            <button class="btn btn-outline" onclick="filterSignals('active')">
                <i class="fas fa-check-circle"></i> Active
            </button>
            <button class="btn btn-outline" onclick="filterSignals('inactive')">
                <i class="fas fa-times-circle"></i> Inactive
            </button>
        </div>
        
        <div style="position: relative;">
            <i class="fas fa-search" style="position: absolute; left: 1rem; top: 50%; transform: translateY(-50%); color: #94a3b8;"></i>
            <input type="text" class="form-control" placeholder="Search signals..." 
                   style="padding-left: 2.5rem; width: 300px;" 
                   onkeyup="searchSignals(this.value)">
        </div>
    </div>
</div>

<!-- Signals Table -->
<div class="card">
    <div class="card-header">
        <h2 class="card-title">
            <i class="fas fa-traffic-light"></i> All Signals
        </h2>
        <div class="flex gap-2">
            <span class="badge badge-success" id="activeCount">0 Active</span>
            <span class="badge badge-danger" id="inactiveCount">0 Inactive</span>
        </div>
    </div>
    
    <div id="signalsContainer">
        <div class="flex-center" style="padding: 3rem;">
            <div class="spinner"></div>
        </div>
    </div>
</div>

<!-- Statistics Cards -->
<div class="grid-3">
    <div class="card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
        <h4 style="margin-bottom: 1rem;">
            <i class="fas fa-chart-line"></i> Average Efficiency
        </h4>
        <div style="font-size: 2.5rem; font-weight: 700;">87.5%</div>
        <p style="opacity: 0.8; margin-top: 0.5rem;">Across all signals</p>
    </div>
    
    <div class="card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white;">
        <h4 style="margin-bottom: 1rem;">
            <i class="fas fa-car"></i> Total Vehicles
        </h4>
        <div style="font-size: 2.5rem; font-weight: 700;">152.3K</div>
        <p style="opacity: 0.8; margin-top: 0.5rem;">Processed this month</p>
    </div>
    
    <div class="card" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white;">
        <h4 style="margin-bottom: 1rem;">
            <i class="fas fa-clock"></i> Avg Wait Time
        </h4>
        <div style="font-size: 2.5rem; font-weight: 700;">4.2s</div>
        <p style="opacity: 0.8; margin-top: 0.5rem;">Per vehicle</p>
    </div>
</div>

<!-- Performance Insights -->
<div class="card">
    <h3 class="card-title">
        <i class="fas fa-lightbulb"></i> Performance Insights
    </h3>
    
    <div class="grid-2" style="margin-top: 1.5rem;">
        <div style="background: #f8fafc; padding: 1.5rem; border-radius: 12px; border-left: 4px solid var(--success);">
            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                <div style="width: 50px; height: 50px; border-radius: 12px; background: rgba(16, 185, 129, 0.1); display: flex; align-items: center; justify-content: center;">
                    <i class="fas fa-arrow-up" style="color: var(--success); font-size: 1.5rem;"></i>
                </div>
                <div>
                    <h4 style="color: var(--dark);">Top Performer</h4>
                    <p style="color: #64748b; font-size: 0.9rem;">Main St. Junction - 95.2% efficiency</p>
                </div>
            </div>
        </div>
        
        <div style="background: #f8fafc; padding: 1.5rem; border-radius: 12px; border-left: 4px solid var(--warning);">
            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                <div style="width: 50px; height: 50px; border-radius: 12px; background: rgba(245, 158, 11, 0.1); display: flex; align-items: center; justify-content: center;">
                    <i class="fas fa-exclamation-triangle" style="color: var(--warning); font-size: 1.5rem;"></i>
                </div>
                <div>
                    <h4 style="color: var(--dark);">Needs Attention</h4>
                    <p style="color: #64748b; font-size: 0.9rem;">Oak Ave. Crossing - 72.1% efficiency</p>
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script>
function filterSignals(status) {
    // Update button states
    document.querySelectorAll('.topbar-actions .btn').forEach(btn => {
        btn.classList.remove('btn-primary');
        btn.classList.add('btn-outline');
    });
    event.target.classList.remove('btn-outline');
    event.target.classList.add('btn-primary');
    
    // Filter table rows based on status
    const rows = document.querySelectorAll('#signalsContainer tbody tr');
    rows.forEach(row => {
        const badge = row.querySelector('.badge');
        if (status === 'all' || badge.textContent.toLowerCase().includes(status)) {
            row.style.display = '';
        } else {
            row.style.display = 'none';
        }
    });
}

function searchSignals(query) {
    const rows = document.querySelectorAll('#signalsContainer tbody tr');
    const lowerQuery = query.toLowerCase();
    
    rows.forEach(row => {
        const text = row.textContent.toLowerCase();
        row.style.display = text.includes(lowerQuery) ? '' : 'none';
    });
}
</script>
{% endblock %}